



                              QTree V1.12
                              ===========


                           SciTech Software

                             23 Stag Leys,
                               Ashtead,
                                Surrey.
                               KT21 2TD.

                        Tel.: +44 (0)372 275775
                        Fax.: +44 (0)372 813069


                            Now working at:

              Biomolecular Structure and Modelling Unit,
          Department of Biochemistry and Molecular Biology,
                      University College London,
                            Gower Street,
                           LONDON WC1E 6BT


   =====================================================================

      EMail: martin@biochem.ucl.ac.uk

      -or-   (if that doesn't work --- your system manager's fault!)
             martin@bsm.bioc.ucl.ac.uk

   =====================================================================


   QTree is Copyright (c) 1993-4, Dr. Andrew C.R. Martin


   The executable program and source code are freely distributable,
   providing all files are distributed intact. Further versions of 
   the file graphics.c may also be distributed with the software to
   provide supprt for alternative hardware platforms and display
   devices.

   With the exception of additional versions of graphics.c, you may not
   distribute any changes you make to QTree. Please send any such 
   changes to SciTech Software so that they can be incorporated into
   future releases of the software.

   Please note that the source code may NOT be used for any other 
   purposes without the prior permission of SciTech Software. This is
   because it is intended to produce a library of such routines which
   will be made available (probably in the form of a book).
                              
   =====================================================================




Introduction
============

   QTree is a program for generating space-filling pictures of molecules
from PDB files. The code is written to be as portable as possible. Only 
the routines in graphics.c need to be changed to support the display 
device being used. 

   QTree and its support programs, Worms and BallStick have been
compiled and tested on Commodore Amiga, Evans & Sutherland ESV running
Unix (native compiler), and on a PC running Linux (Gnu C compiler).
It should run on anything else with no problems!

   As of V1.5 of QTree, graphics.c has been changed simply to create
a 24bit RGB image in MTV raytracer format. No direct graphics device
support is provided. You are encouraged to maintain this form and
thus to write a separate utility to display MTV files on your graphics
device. Source code for reading an MTV file is provided. If you
really must, you may modify graphics.c to drive your graphics
directly, but the other route is preferable for ease of portability
of the code.

   Under UNIX/X-Windows, MTV graphics files may be displayed using the
ImageMagick display program.

   Worms is a preprocessor program for QTree which allows the generation 
of worm style images showing a B-spline smoothed image of the C-alpha 
trace. It reads a PDB file and writes a PDB file containing the 
interpolated smoothed atom positions necessary to generate the worms 
image.

   BallStick is a preprocessor program for QTree which allows the 
generation of ball and stick style images. It reads a PDB file and writes 
a PDB file containing interpolated sphere positions along each bond.

   As of V1.11, the files generated by BallStick are different: the radii
are stored in the occupancy column rather than the temperature factor
column. The allows the colouring on temperature factors (introduced in
V1.10) to be performed with ball & stick representations. This means
that BallStick output files generated with versions prior to V1.11
will not be compatible with the latest version of QTree. A simple
Perl or awk script may be used to swap the B-value and occupancy columns
of an old BallStick output file if required.

   In the explanations which follow, items enclosed in square brackets 
are optional; items in angle brackets should be replaced by suitable 
values.



Running QTree
=============

   Required files
   --------------
   
   qtree                The executable program
   qtree.hlp            The help file. This should be in the current
                        directory, or a directory with the logical name
                        HELP: (VMS/AmigaDOS), or in a directory whose
                        name is placed in the environment variable
                        HELPDIR (Unix)
   
   
   Running the program
   -------------------

   Simply type:
   
      qtree <file.pdb> <file.mtv>         (CPK & Worms images)

   A control file (read the help information with qtree -h) may be
specified. For example:
   
      qtree -c <ctrl.dat> <file.pdb> <file.mtv>

   If generating ball and stick images after using the BallStick 
preprocessor, you should use the -b flag. For example:
   
      qtree -b -c <ctrl.dat> <file.stk> <file.mtv>

   The size of the square used to perform the calculations may be 
specified using the -r option. (Defaults to 512). For example:

      qtree -r 256 <file.pdb> <file.mtv>

   The size of the screen used (i.e. the dimensions of the output file)
are specified with the -s option. (Defaults to 800x600.) For example:

      qtree -r 256 -s 256 256 <file.pdb> <file.mtv>





   24-bit output is created in a format compatible with the MTV ray 
tracer.
      



   To get further help, type
   
      qtree -h
      
      

      
Running Worms
=============

   Required files
   --------------

   worms                The executable program

   Running the program
   -------------------

   Simply type:
   
      worms [-n <n>] [-s <n>] [-d] <in.pdb> <out.pdb>
   
   The -n switch is followed by an integer which specifies the
   number of sphere to be placed between smoothed atom positions
   (default: 30).

   The -d switch causes division smoothing to be used instead of
   B-spline smoothing.
   
   The -s switch is followed by an integer division smoothing factor 
   (default: 4). This option is ignored if -d has not been specified.
   
   
   
Running BallStick
=================

   Required files
   --------------
   
   BallStick            The executable program
   
   Running the program
   -------------------
      
   Simply type:
   
      BallStick [-n <n>] [-b <b>] [-s <s>] [-d] <in.pdb> <out.pdb>
      
   The -n switch is followed by an integer specifying the number of small
   spheres to be placed along each bond (default: 30). With large 
   structures it may be necessary to reduce this number to reduce memory 
   usage by qtree. With small structures, you may wish to increase this
   value to get smoother sticks.
   
   The -b switch is followed by a floating point number which specifies
   the ball radius (default 0.4).
   
   The -s switch is followed by a floating point number which specifies
   the stick radius (default 0.2).

   The -d switch stops sticks from being created between disulphides.
   


Documentation
=============

   There is no separate documentation other than what is supplied here
since there is an extensive help facility built into the QTree program.
Type qtree -h to access this help facility. (N.B. You must either have
qtree.hlp in your current directory, or in the directory pointed to
by the environment variable HELPDIR to access help.)

   A simple command file for QTree, restype.dat, is supplied which 
colours on residue type with a shaded background and specular reflections.

      
      
Compiling QTree, Worms and BallStick
====================================

   When you unpack the tar file, you will obtain a QTreeVx.xx directory
with a subdirectory called bioplib.

   Enter the QTreeVx.xx directory and modify the makefile to change the
name of the C compiler for your system if required. You may also modify
qtree.h to change some default values and switch off compilation of some
optional sections. The following values may be changed:

SIZE            This is the actual image size and must be a power of 2
                (Overridden with -r flag)
XSIZE, YSIZE    This is the size of the background on which the image will
                be placed. Both values must be larger than SIZE
                (Overridden with -s flag)
DEPTHCUE        If this is not defined, code to handle depth cueing will
                not be compiled
SPEC            If this is not defined, code to handle specular reflections
                will not be compiled
SHOW_INFO       If this defined, the run time and pixel saturation will be
                shown at the end of the run. ESVs don't seem to have the
                required system calls...
OVERLAP_SLAB    If defined, Z-slab regions will include any atoms which
                partially overlap the slab region; if not the centre of
                the atom must be within the region.


Below are listed the files contained in this distribution

   Source files
   ------------
      qtree.c        The QTree program
      qtree.h        Structure definitions, globals and flags
      qtree.p        Prototypes for qtree.c
      graphics.c     Graphics support routines
      graphics.p     Prototypes for graphics.c
      commands.c     Command parser setup and handling
      commands.p     Prototypes for commands.c

      worms.c        The Worms program
      
      BallStick.c    The Ball and Stick program

   Additional source files
   -----------------------
      ColourGraphics.c  An example of driving colour graphics directly
                        (replaces graphics.c)
      GreyGraphics.c    An example of driving grey-scale graphics directly
                        (replaces graphics.c)
      mtvham.c          Code to display an MTV file in HAM mode on the 
                        Commodore Amiga
      ReadMTV.c         Code to read an MTV graphics file

      
   Required library files and includes
   -----------------------------------
      These should be placed in a sub-directory of the QTree directory
      called `bioplib'.
   
      macros.h          Generally useful C programming macros
      MathType.h        Maths type definitions
      SysDefs.h         General system type definitions
      pdb.h             PDB structure definitions and library prototypes
      help.h            Help interface prototype include
      parse.h           Command line parser defines and prototype include
      general.h         General C library routine prototype include
      matrix.h          Matrix handling prototype include
      WindIO.h          Window I/O routine prototype include
      fsscanf.h         Hard formatted string scan include
      CursWind.h        Curses/windowing prototype include
      angle.h           Angle calculation include
      array.h           2D array creation include

      RotPDB.c          Rotate a PDB linked list
      ReadPDB.c         Read a PDB file
      WritePDB.c        Write a PDB file
      help.c            Help file handler
      matrix.c          Matrix manipulation routines
      parse.c           Comman line parser
      general.c         General routines
      fsscanf.c         Hard formatted string scan
      WindIO.c          Window I/O routines
      ModPDB.c          Modify coordinates in a PDB linked list
      ApMatPDB.c        Apply a rotation matrix to a PDB linked list
      OrigPDB.c         Move a PDB linked list to origin
      GetCGPDB.c        Get centre of geometry from a PDB linked list
      ParseRes.c        Parse a residue specification
      CalcPDB.c         Perform calculations on PDB linked list
      PDBList.c         Manipulate PDB linked list
      array.c           2D array generation code


   N.B. Compiling on MS-DOS machines will require modification of the
   path names for include files to reflect the backslash path separator
   (i.e. change bioplib/... to bioplib\...). The VAX/VMS C compiler is 
   intelligent enough to cope with slash separted paths even though VMS 
   uses a dot (.) to separate paths.  A number of the filenames are too 
   long for use with MS-DOS and these will also have to be changed. 
   (Suggestion: use a decent operating system like Linux!!)


Possible Future Enhancements
============================

   1. Progress indicator
   2. Non-square image support
   
